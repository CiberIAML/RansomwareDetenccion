<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Deteccion de Ransomware</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-image: url('{{ url_for('static', filename='img/background.png') }}');
        }

        .card {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        input,
        button,
        select {
            padding: 10px;
            width: 100%;
            margin-top: 8px;
        }

        button {
            background: #0044ff;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 8px;
        }

        button:hover {
            background: #0033cc;
        }

        pre {
            background: #f3f3f3;
            padding: 15px;
        }
    </style>
</head>

<body>
    <h1>üîê Detecci√≥n de Ransomware en Archivos Ejecutables de Windows</h1>
    <p>Sube un archivo o ingresa los valores manualmente.</p>

    <div class="card">
        <h2>üìÅ Subir archivo EXE</h2>
        <input type="file" id="fileInput" />
        <button onclick="uploadFile()">Analizar archivo</button>
    </div>

    <div class="card">
        <h2>‚úçÔ∏è Ingresar valores manualmente</h2>

        <div id="manualFields"></div>
        <button onclick="predictManual()">Clasificar Manual</button>
    </div>

    <div class="card">
        <h2>Resultado</h2>
        <pre id="result">Aqu√≠ aparecer√° la respuesta...</pre>
    </div>

    <script>
        // üî• URL REAL DE TU API:
        const API_URL = "https://ransomwaredetenccion.onrender.com";

        const fields = [
            "Machine", "DebugSize", "DebugRVA", "MajorImageVersion", "MajorOSVersion",
            "ExportRVA", "ExportSize", "IatVRA", "MajorLinkerVersion", "MinorLinkerVersion",
            "NumberOfSections", "SizeOfStackReserve", "DllCharacteristics", "ResourceSize",
            "BitcoinAddresses"
        ];

        window.onload = () => {
            let html = "";
            fields.forEach(f => {
                html += `<label>${f}</label>
                 <input type="number" id="${f}" placeholder="Ingresa ${f}">`;
            });
            document.getElementById("manualFields").innerHTML = html;
        };

        async function uploadFile() {
            const fileInput = document.getElementById("fileInput");
            if (!fileInput.files.length) return alert("Selecciona un archivo");

            const formData = new FormData();
            formData.append("file", fileInput.files[0]);

            const res = await fetch(`${API_URL}/predict`, {
                method: "POST",
                body: formData
            });

            const data = await res.json();
            document.getElementById("result").textContent = JSON.stringify(data, null, 2);
        }

        async function predictManual() {
            const payload = {};
            fields.forEach(f => payload[f] = Number(document.getElementById(f).value));

            const res = await fetch(`${API_URL}/predict_manual`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });

            const data = await res.json();
            document.getElementById("result").textContent = JSON.stringify(data, null, 2);
        }
    </script>

    <footer>
        <p>&copy; 2025 Detecci√≥n de Ransomware en Archivos Ejecutables de Windows PE. Modelo de Machine Learning para fines acad√©micos y de prueba. Desarrollado por Equipo TALENTO TECH.</p>
    </footer>

</body>

</html>